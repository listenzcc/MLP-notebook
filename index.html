<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Experiment of MLP</title>
        <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

/* From extension ms-toolsai.jupyter */
/* These classnames are inherited from bootstrap, but are present in most notebook renderers */

.alert {
    width: auto;
    padding: 1em;
    margin-top: 1em;
    margin-bottom: 1em;
}
.alert > *:last-child {
    margin-bottom: 0;
}
#preview > .alert:last-child {
    /* Prevent this being set to zero by the default notebook stylesheet */
    padding-bottom: 1em;
}

.alert-success {
    /* Note there is no suitable color available, so we just copy "info" */
    background-color: var(--theme-info-background);
    color: var(--theme-info-foreground);
}
.alert-info {
    background-color: var(--theme-info-background);
    color: var(--theme-info-foreground);
}
.alert-warning {
    background-color: var(--theme-warning-background);
    color: var(--theme-warning-foreground);
}
.alert-danger {
    background-color: var(--theme-error-background);
    color: var(--theme-error-foreground);
}

</style>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="experiment-of-mlp">Experiment of MLP</h1>
<p><a href="https://en.wikipedia.org/wiki/Multilayer_perceptron" title="MLP">MLP</a>
: Multilayer perception,</p>
<blockquote>
<p>A multilayer perceptron (MLP) is a fully connected class of feedforward artificial neural network (ANN). The term MLP is used ambiguously, sometimes loosely to mean any feedforward ANN, sometimes strictly to refer to networks composed of multiple layers of perceptrons (with threshold activation); see ยง Terminology. Multilayer perceptrons are sometimes colloquially referred to as &quot;vanilla&quot; neural networks, especially when they have a single hidden layer.[1]</p>
</blockquote>
<p>I will make some experiment about it.</p>
<hr>
<h2 id="experiment-1">Experiment-1</h2>
<p>The experiment is performed to test the edge of the MLP.</p>
<p>The spiral shaped point clouds are built,
and the MLP is used to predict one from another.</p>
<p>Currently, in 20230101, the MLP estimates at a quite low accuracy.
The experiment code is provided in
<a href="./experiment-1/main.py">experiment-1/main.py</a>.</p>
<p>The MLP is built by torchvision,
and the learning process is defined as following.</p>
<pre><code class="language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Net</span>(nn.Module):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">super</span>().__init__()
        self.mlp = torchvision.ops.MLP(<span class="hljs-number">2</span>, [<span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>], activation_layer=nn.LeakyReLU)
        self.sig = nn.Tanh()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        <span class="hljs-keyword">return</span> self.sig(self.mlp(x))


net = Net().cuda()

lr = <span class="hljs-number">1e-2</span>
optimizer = torch.optim.AdamW(net.parameters(), lr)
criterion = nn.MSELoss()
</code></pre>
<p>The model is trained for 1000 times,
and the outcome ends at</p>
<table>
<thead>
<tr>
<th style="text-align:center">Step</th>
<th style="text-align:center">Loss(train)</th>
<th style="text-align:center">Loss(test)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0960</td>
<td style="text-align:center">0.0280</td>
<td style="text-align:center">0.0251</td>
</tr>
<tr>
<td style="text-align:center">0970</td>
<td style="text-align:center">0.0213</td>
<td style="text-align:center">0.0251</td>
</tr>
<tr>
<td style="text-align:center">0980</td>
<td style="text-align:center">0.0223</td>
<td style="text-align:center">0.0251</td>
</tr>
<tr>
<td style="text-align:center">0990</td>
<td style="text-align:center">0.0234</td>
<td style="text-align:center">0.0254</td>
</tr>
</tbody>
</table>
<p>The dataset of the point clouds are presented in following,
it contains the 2D and 3D versions,
and the third dim of the 3D version are the order of the points.</p>
<p><img src="file:////home/zcc/nfsHome/Workshop/MLP/experiment-1/doc/dataset.png" alt="dataset.png"></p>
<p><img src="file:////home/zcc/nfsHome/Workshop/MLP/experiment-1/doc/dataset-1.png" alt="dataset-1.png"></p>
<p>The outcome shows the prediction,
with a low accuracy.
The 2D and 3D versions are also provided.</p>
<p><img src="file:////home/zcc/nfsHome/Workshop/MLP/experiment-1/doc/pred.png" alt="pred.png"></p>
<p><img src="file:////home/zcc/nfsHome/Workshop/MLP/experiment-1/doc/pred-1.png" alt="pred-1.png"></p>
<div>
<iframe src='./experiment-1/doc/spiral-1.html' style='width: 800px; height: 800px'></iframe>
<iframe src='./experiment-1/doc/spiral-2.html' style='width: 800px; height: 800px'></iframe>
<div>
        
        
    </body>
    </html>